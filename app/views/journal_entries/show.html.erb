<div class="px-4 py-8 sm:px-6 lg:px-8">
  <div class="mx-auto w-full max-w-5xl">
    <%= render "header",
      title: "Journal",
      subtitle: "Une entrÃ©e du journal de trading" do %>

      <%= link_to "â† Retour", journal_entries_path,
        class: "text-sm text-gray-400 hover:text-gray-200" %>

      <%= link_to "âœï¸ Ã‰diter", edit_journal_entry_path(@journal_entry),
        class: "inline-flex items-center gap-2 rounded-xl px-4 py-2
                bg-gray-900/70 border border-gray-700 text-gray-200
                hover:bg-gray-800 hover:border-gray-600 transition" %>

      <%= button_to "ðŸ—‘ï¸ Supprimer", @journal_entry, method: :delete,
        data: { turbo_confirm: "Supprimer cette entrÃ©e ?" },
        class: "inline-flex items-center gap-2 rounded-xl px-4 py-2
                bg-rose-900/30 border border-rose-700/60 text-rose-200
                hover:bg-rose-700/20 hover:border-rose-500/70 transition" %>
    <% end %>

    <% mood_badge =
      case @journal_entry.mood
      when "red" then ["ðŸ”´", "text-rose-300 bg-rose-500/10 border-rose-700/50"]
      when "amber" then ["ðŸŸ¡", "text-amber-300 bg-amber-500/10 border-amber-700/50"]
      when "green" then ["ðŸŸ¢", "text-emerald-300 bg-emerald-500/10 border-emerald-700/50"]
      else ["â€¢", "text-gray-300 bg-white/5 border-gray-700"]
      end
    %>

    <section class="mt-6 bg-gray-800/80 border border-gray-700 rounded-2xl p-6 sm:p-8 shadow-xl">
      <div class="flex flex-wrap items-start justify-between gap-3">
        <div class="text-sm text-gray-400">
          <span class="font-mono text-gray-200"><%= @journal_entry.occurred_at.strftime("%Y-%m-%d %H:%M") %></span>
          <% if @journal_entry.kind.present? %>
            Â· <span class="text-gray-300"><%= @journal_entry.kind %></span>
          <% end %>
          <% if @journal_entry.btc_price_eur.present? %>
            Â· <span class="text-gray-300"><%= number_to_currency(@journal_entry.btc_price_eur, unit: "â‚¬", format: "%n %u") %></span>
          <% end %>
        </div>

        <span class="text-xs px-2 py-1 rounded-full border <%= mood_badge[1] %>"><%= mood_badge[0] %></span>
      </div>

      <% if @journal_entry.context.present? %>
        <div class="mt-4 bg-gray-900/70 border border-gray-700 rounded-xl p-4">
          <p class="text-[11px] uppercase tracking-wide text-gray-400 mb-1">Contexte</p>
          <p class="text-sm text-gray-200"><%= @journal_entry.context %></p>
        </div>
      <% end %>

      <% if @journal_entry.body.present? %>
        <div class="mt-4">
          <p class="text-[11px] uppercase tracking-wide text-gray-400 mb-2">Note</p>
          <div class="bg-black/20 border border-gray-700 rounded-xl p-4">
            <p class="text-sm text-gray-200 whitespace-pre-line"><%= @journal_entry.body %></p>
          </div>
        </div>
      <% end %>

      <% tags = @journal_entry.respond_to?(:tags_list) ? @journal_entry.tags_list : @journal_entry.tags.to_s.split(",").map(&:strip).reject(&:blank?) %>
      <% if tags.any? %>
        <div class="mt-4">
          <p class="text-[11px] uppercase tracking-wide text-gray-400 mb-2">Tags</p>
          <div class="flex flex-wrap gap-2">
            <% tags.each do |t| %>
              <span class="text-xs px-2 py-1 rounded-full border border-gray-700 bg-black/20 text-gray-300"><%= t %></span>
            <% end %>
          </div>
        </div>
      <% end %>
    </section>
  </div>
</div>
