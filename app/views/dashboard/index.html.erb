<%# app/views/dashboard/index.html.erb %>

<div class="px-4 py-8 sm:px-6 lg:px-8">
  <div class="mx-auto w-full max-w-5xl lg:max-w-7xl xl:max-w-screen-xl">

    <header class="mb-8">
      <h1 class="text-3xl sm:text-4xl font-bold tracking-tight mb-2">Bitcoin Monitor</h1>
      <p class="text-sm text-gray-400">Dashboard on-chain • lecture quotidienne • outils d’analyse</p>

      <%= render "dashboard/shortcuts" %>
    </header>

    <%= render "dashboard/active_position",
      active_position: @active_position,
      sell_now: @sell_now,
      combo_series: @combo_series %>

    <%= render "dashboard/market_context" %>

    <div class="mt-4 border-l-4 border-indigo-500 bg-gray-900/40 px-4 py-3 rounded-r-lg">
      <p class="text-sm text-gray-300 italic leading-relaxed">
        “Un bon trader Bitcoin n’essaie pas d’être plus malin que le marché.
        Il essaie d’être moins stupide que lui-même.”
      </p>
    </div>

    <%= render "dashboard/price_zones" %>
    <%= render "dashboard/true_exchange_flow" %>

    <%= render "dashboard/daily_reading" %>
    <%= render "dashboard/weekly_read" %>

    <%= render "dashboard/ai_insight", ai_insight: @ai_insight, simple_mode: simple_mode? if @ai_insight.present? %>

    <% if @error %>
      <div class="bg-red-900/40 border border-red-700 text-red-200 rounded-xl p-4 mt-4">
        Erreur de connexion RPC Bitcoin : <%= @error %>
      </div>
    <% else %>
      <%= render "dashboard/system_status",
            blockchain: @blockchain,
            mempool: @mempool,
            lightning_status: @lightning_status %>

      <%= render "dashboard/ordinals_status",
            brc20_scan_stats: @brc20_scan_stats,
            brc20_scan_done: @brc20_scan_done,
            brc20_last_sync_run: @brc20_last_sync_run %>

      <%= render "dashboard/rules_center", monitoring_rules: @monitoring_rules %>
    <% end %>

    <%= render "shared/footer" %>
  </div>
</div>
